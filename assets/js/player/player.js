import audios from"./data.js";import elements from"./elements.js";import*as utils from"./utils.js";export default{audioData:audios,currentPlaying:utils.currentIndex(),currentAudio:{},isPlaying:!1,savedMuted:!1,savedVolume:1,start(){elements.get.call(this),this.update(),this.volumeControl.value=100},play(){this.isPlaying=!0,this.audio.play(),this.playPauseButton.innerHTML=this.pauseIcon},pause(){this.isPlaying=!1,this.audio.pause(),this.playPauseButton.innerHTML=this.playIcon},togglePlayPause(){this.isPlaying?this.pause():this.play()},swap(t){this.currentPlaying=t,this.pause(),this.update(),this.play()},next(){let t=this.currentPlaying+1;t===this.audioData.length&&(t=0),this.swap(t)},back(){let t=this.currentPlaying-1;-1===t&&(t=this.audioData.length-1),this.swap(t)},toggleMute(){this.audio.muted=!this.audio.muted,this.savedMuted=this.audio.muted,this.volumeButton.innerHTML=this.audio.muted?this.mutedIcon:this.soundIcon},setVolume(t){this.savedVolume=t/100,this.audio.volume=this.savedVolume},setSeekbar(t){this.audio.muted=!0,this.audio.currentTime=t},timeUpdate(){const t=this.audio.currentTime,i=utils.convertTo12HourFormat(t);Math.ceil(this.seekbar.value)!=Math.ceil(t)&&(this.seekbar.value=t),this.currentDuration.innerText!==i&&(this.currentDuration.innerText=i),this.savedMuted||this.seekbar.dragging||(this.audio.muted=!1),"mediaSession"in navigator&&"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:this.audio.duration||0,playbackRate:this.audio.playbackRate||1,position:this.audio.currentTime||0})},update(){(this.currentPlaying<0||this.currentPlaying>this.audioData.length)&&(this.currentPlaying=0),this.currentAudio=this.audioData[this.currentPlaying],this.cover.src=utils.imageURL(this.currentAudio.cover),this.title.innerText=this.currentAudio.title,this.artist.innerText=this.currentAudio.artist,"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:this.currentAudio.title,artist:this.currentAudio.artist,artwork:[{src:this.cover.src,sizes:"512x512",type:"image/webp"}]}));const t=utils.audioURL(this.currentAudio.file);elements.createAudioElement.call(this,t),this.downloadButton.href=t,this.downloadButton.download=utils.generateFilename(this.currentAudio.file,this.currentAudio.artist,this.currentAudio.title),window.location.hash=this.currentPlaying+1,document.title=this.currentAudio.title+" | "+this.currentAudio.artist,this.audio.onloadeddata=(()=>{elements.actions.call(this),this.audio.muted=this.savedMuted,this.audio.volume=this.savedVolume})}};